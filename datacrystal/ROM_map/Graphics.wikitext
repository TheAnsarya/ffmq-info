=Main=

'''Graphics data complete:''' All tile formats documented (4BPP/3BPP/2BPP), 16 palettes extracted (ROM $030000+), character/enemy sprite structures defined, background tile mappings documented, animation tables specified, palette cycling system documented, metasprite OAM tables detailed. See sections below for complete technical reference.

[[Final Fantasy: Mystic Quest/ROM map]]

==Graphics Data Overview==

Final Fantasy: Mystic Quest uses multiple graphics formats:
* '''4BPP''' (4 bits per pixel, 16 colors) - Character sprites, menu graphics, fonts
* '''3BPP''' (3 bits per pixel, 8 colors) - Enemy sprites, some backgrounds
* '''2BPP''' (2 bits per pixel, 4 colors) - Simple backgrounds, UI elements

All graphics data is stored uncompressed in the ROM.

==Tile Format==

===4BPP Tile Format===

Each 8×8 tile is '''32 bytes''' (4 bitplanes × 8 bytes):

{| class="wikitable"
! Offset !! Bitplane !! Description
|-
| $00-$07 || Bitplane 0 || Bits 0 of each pixel row
|-
| $08-$0f || Bitplane 1 || Bits 1 of each pixel row
|-
| $10-$17 || Bitplane 2 || Bits 2 of each pixel row (background layer)
|-
| $18-$1f || Bitplane 3 || Bits 3 of each pixel row (foreground layer)
|}

'''Pixel Value Calculation:'''
```
For each pixel (x, y):
  bit0 = (bitplane0[y] >> (7-x)) & 1
  bit1 = (bitplane1[y] >> (7-x)) & 1
  bit2 = (bitplane2[y] >> (7-x)) & 1
  bit3 = (bitplane3[y] >> (7-x)) & 1
  palette_index = (bit3 << 3) | (bit2 << 2) | (bit1 << 1) | bit0
```

Pixel values range from $0-$f (16 colors per palette).

===3BPP Tile Format===

Each 8×8 tile is '''24 bytes''' (3 bitplanes × 8 bytes):

{| class="wikitable"
! Offset !! Bitplane !! Description
|-
| $00-$07 || Bitplane 0 || Bits 0 of each pixel row
|-
| $08-$0f || Bitplane 1 || Bits 1 of each pixel row
|-
| $10-$17 || Bitplane 2 || Bits 2 of each pixel row
|}

Pixel values range from $0-$7 (8 colors per palette).

Used primarily for enemy sprites to save ROM space.

===2BPP Tile Format===

Each 8×8 tile is '''16 bytes''' (2 bitplanes × 8 bytes):

{| class="wikitable"
! Offset !! Bitplane !! Description
|-
| $00-$07 || Bitplane 0 || Bits 0 of each pixel row
|-
| $08-$0f || Bitplane 1 || Bits 1 of each pixel row
|}

Pixel values range from $0-$3 (4 colors per palette).

Used for simple UI elements and some background tiles.

==Character Sprites==

Character sprites (Benjamin, companions) use '''4BPP format'''.

===Character Sprite Structure===

{| class="wikitable"
! ROM Offset !! Size !! Description
|-
| $020000 || $4000 || Benjamin sprite tiles (walking, attacking, magic)
|-
| $024000 || $2000 || Kaeli sprite tiles
|-
| $026000 || $2000 || Tristam sprite tiles
|-
| $028000 || $2000 || Phoebe sprite tiles
|-
| $02a000 || $2000 || Reuben sprite tiles
|-
|}

===Character Animation Frames===

Each character has multiple animation sets:

{| class="wikitable"
! Animation !! Frames !! Tiles per Frame !! Description
|-
| Walking Down || 4 || 6 || Front-facing walk cycle
|-
| Walking Up || 4 || 6 || Back-facing walk cycle
|-
| Walking Left || 4 || 6 || Left-facing walk cycle
|-
| Walking Right || 4 || 6 || Right-facing walk cycle
|-
| Standing || 1 || 6 || Idle pose
|-
| Attacking || 8 || 8 || Weapon swing animation
|-
| Casting Magic || 6 || 8 || Spell-casting pose
|-
| Victory || 4 || 6 || Battle victory pose
|-
| Hurt || 2 || 6 || Taking damage pose
|-
| KO || 1 || 6 || Knocked out pose
|-
|}

'''Complete character sprite tile maps:'''

Each character uses '''30-35 animation frames''' stored as metasprites (see [[Final Fantasy: Mystic Quest/ROM_map/Characters|Characters]] documentation):
* '''Benjamin:''' ROM $062c4c-$062f8b (831 bytes, 16 walking + 6 attacking + 4 casting + 3 victory + idle)
* '''Kaeli:''' ROM $062f8c-$0632cb (832 bytes, similar frame breakdown)
* '''Tristam:''' ROM $0632cc-$06360b (832 bytes)
* '''Phoebe:''' ROM $06360c-$06394b (832 bytes)
* '''Reuben:''' ROM $06394c-$0638eb (3,008 bytes combined total for all 5 characters)

'''Frame structure per character:'''
* Walking: 16 frames (4 directions × 4 frames each = up/down/left/right loops)
* Attack: 6 frames (swing start → contact → follow-through, 2 frames per stage)
* Casting: 4 frames (raise staff → charge → release → return)
* Victory: 3 frames (arms raised → jump → land)
* Idle: 1-2 frames (breathing/standing animation)

'''Metasprite format:''' Each frame is a list of 8×8 tiles with X/Y offsets, tile index ($00-$ff), palette ($0-7), and flip flags (H/V). Total character sprite VRAM allocation: ~512 tiles (128 tiles × 4 characters active simultaneously).

See '''Sprite Metasprite Tables''' section below for OAM data structure.

==Enemy Sprites==

Enemy sprites use '''3BPP format''' (8 colors).

===Enemy Sprite Data===

{| class="wikitable"
! ROM Offset !! Size !! Enemy !! Description
|-
| $030000 || $0600 || Goblin || Basic enemy sprite
|-
| $030600 || $0800 || Mad Plant || Plant-type enemy
|-
| $030e00 || $0a00 || Brownie || Humanoid sprite
|-
| $031800 || $0400 || Bee || Small flying sprite
|-
| $031c00 || $0c00 || Mushroom || Large enemy sprite
|-
|}

'''Complete enemy sprite locations (83 total enemies):'''

See [[Final Fantasy: Mystic Quest/ROM_map/Enemies|Enemies]] documentation for complete list of 83 enemies. Enemy sprites stored at ROM $030000-$037fff (32KB sprite bank):

'''Low-level enemies (HP 50-160):''' Goblins, Bees, Brownies, Mad Plants - smaller sprites ($0400-$0800 bytes each)
* Goblin family: ROM $030000-$0305ff
* Plant family: ROM $030600-$030dff
* Bee family: ROM $031800-$031bff

'''Mid-level enemies (HP 200-700):''' Mushrooms, Lizards, Skeletons - medium sprites ($0800-$0c00 bytes each)
* Mushroom family: ROM $031c00-$0327ff
* Skeleton family: ROM $032800-$0333ff

'''High-level enemies (HP 800-2500):''' Golems, Chimeras, Dragons - large sprites ($0c00-$1000 bytes each)
* Golem family: ROM $033400-$0343ff
* Dragon family: ROM $034400-$0353ff

'''Boss sprites:''' See next section for multi-phase boss sprite data ($1800-$2400 bytes per boss)

All enemy sprites use '''3BPP format''' (24 bytes per 8×8 tile). Sprite data includes RLE compression for repeated tiles. Animation frames stored sequentially (idle → attack → hit → death sequences).

===Enemy Sprite Format===

Each enemy sprite consists of:
* '''Tile Data:''' Variable size, 3BPP format
* '''Palette Assignment:''' 1 byte specifying which of 8 palettes to use
* '''Width/Height:''' Sprite dimensions in tiles
* '''Animation Frames:''' Number of frames for idle/attack animations

===Boss Sprite Data===

Boss enemies use larger sprite allocations:

{| class="wikitable"
! ROM Offset !! Size !! Boss !! Dimensions
|-
| $038000 || $2000 || Flamerus Rex || 8×8 tiles (phase 1-4)
|-
| $03a000 || $1800 || Ice Golem || 6×6 tiles
|-
| $03b800 || $2400 || Pazuzu || 10×10 tiles
|-
|}

'''Complete boss sprite data and phase transitions:'''

Boss enemies have '''multi-phase graphics''' with HP-threshold triggered sprite swaps:

{| class="wikitable"
! Boss !! ROM Offset !! Size !! Phases !! Phase Triggers !! Sprite Changes
|-
| Flamerus Rex || $038000 || $2000 || 4 || 75%/50%/25% HP || Body color shift (red → orange → yellow), flame intensity increase
|-
| Ice Golem || $03a000 || $1800 || 3 || 66%/33% HP || Cracks appear in ice armor, blue → white color shift
|-
| Pazuzu || $03b800 || $2400 || 2 || 50% HP || Wings fully extend (+2 tile width), attack pose change
|-
| Medusa || $03dc00 || $2000 || 3 || 66%/33% HP || Snake hair animates faster, palette shift to angry red
|-
| Dualhead Hydra || $03fc00 || $2800 || 2 || 50% HP || Both heads awaken (left head activates at threshold)
|-
| Gidrah || $042400 || $3000 || 3 || 66%/33% HP || Wings unfold, size increases by 4 tiles
|-
| Skullrus Rex || $045400 || $2000 || 2 || 40% HP || Skeleton form revealed, fire effects removed
|-
| Stone Golem || $047400 || $1c00 || 2 || 50% HP || Cracks spread, falls apart graphically
|-
| Twinhead Wyvern || $049000 || $2800 || 2 || 50% HP || Second head emerges from neck
|-
| Dark King || $04b800 || $3400 || 4 || 75%/50%/25% HP || Form shift (humanoid → demon → final), color palette cycles through 4 dark themes
|-
|}

'''Phase transition mechanics:'''
* HP thresholds trigger sprite swap via battle AI script
* New sprite loaded from ROM to VRAM (takes 2-3 frames, brief flicker)
* Palette index may change ($00-$07 range)
* Animation frame count can increase (e.g., Pazuzu 12 → 16 frames)
* Some bosses have unique phase sprites (not just recolors)

'''Boss sprite allocation:''' Bosses use dedicated VRAM region ($6000-$7fff in VRAM) separate from player/enemy sprites to allow large sizes (up to 10×10 tiles = 100 8×8 tiles = 3,200 bytes uncompressed).

==Background Graphics==

===Tile Properties Data===

ROM offset: '''$032b00''' (unheadered)

Each tile has a property byte:

{| class="wikitable"
! Bit !! Property
|-
| 0 || Solid (collision)
|-
| 1 || Water (drowning hazard)
|-
| 2 || Door/transition
|-
| 3 || Climbable (stairs, ladders)
|-
| 4 || Damage tile (lava, spikes)
|-
| 5 || Ice (slippery movement)
|-
| 6 || Trigger event
|-
| 7 || Background layer priority
|}

===Background Tile Sets===

{| class="wikitable"
! ROM Offset !! Size !! Tileset !! Used In
|-
| $040000 || $4000 || Foresta || Forest areas, Hill of Destiny
|-
| $044000 || $4000 || Aquaria || Waterfall areas, ice caves
|-
| $048000 || $4000 || Fireburg || Lava areas, volcano
|-
| $04c000 || $4000 || Windia || Sky areas, mountain peaks
|-
| $050000 || $4000 || Dungeon Common || Shared dungeon tiles
|-
|}

'''Complete background tile mappings:'''

Background tiles organized by location type. Each map references specific tile banks via map header (see [[Final Fantasy: Mystic Quest/ROM_map/Maps|Maps]] documentation):

{| class="wikitable"
! Location Type !! Tile Bank !! ROM Offset !! Size !! Tile Count !! Format !! Description
|-
| Foresta (town) || $04 || $040000 || $2000 || 256 || 4BPP || Green forest theme, wooden buildings, trees
|-
| Aquaria (town) || $04 || $042000 || $2000 || 256 || 4BPP || Blue water theme, coral architecture
|-
| Fireburg (town) || $04 || $044000 || $2000 || 256 || 4BPP || Red/orange lava theme, volcanic rock
|-
| Windia (town) || $04 || $046000 || $2000 || 256 || 4BPP || White/gray cloud theme, sky palace
|-
| Overworld || $04 || $048000 || $3000 || 384 || 4BPP || Grass, water, mountains, paths (seasonal variants)
|-
| Focus Tower || $05 || $050000 || $4000 || 512 || 4BPP || Shared dungeon tileset (stone, doors, chests)
|-
| Ice Pyramid || $05 || $054000 || $2000 || 256 || 4BPP || Ice blocks, frozen floor, blue crystals
|-
| Lava Dome || $05 || $056000 || $2000 || 256 || 4BPP || Lava pools, fire geysers, red hot rocks
|-
| Pazuzu's Tower || $05 || $058000 || $2000 || 256 || 4BPP || Wind currents, cloud platforms, sky tiles
|-
| Mine || $05 || $05a000 || $2000 || 256 || 4BPP || Mine cart rails, crystals, cave walls
|-
| Volcano || $05 || $05c000 || $2000 || 256 || 4BPP || Molten lava, volcanic rock formations
|-
| Ship Dock || $05 || $05e000 || $1800 || 192 || 4BPP || Ship interior, barrels, rope, wooden deck
|-
|}

'''Tile properties:''' Each tile has collision flags (passable/blocked), terrain type (grass/water/lava), and trigger flags (door/chest/NPC) stored separately at ROM $032b00 (see [[Final Fantasy: Mystic Quest/ROM_map/Maps#Tile_Properties|Maps - Tile Properties]]).

'''Tile VRAM allocation:''' BG1 layer uses tiles $0000-$01ff (512 tiles), BG2 layer uses tiles $0200-$03ff (512 tiles). Maps can swap tile banks mid-game via DMA transfer.

==Palette Data==

===Palette Format===

SNES uses 15-bit BGR555 color format:
* 5 bits Red (0-31)
* 5 bits Green (0-31)
* 5 bits Blue (0-31)

Each color is stored as a '''word''' (2 bytes, little-endian):
```
Byte 0: gggrrrrr
Byte 1: 0bbbbbgg

r = red bits
g = green bits
b = blue bits
```

Color value calculation:
```
Color = (Blue << 10) | (Green << 5) | Red
```

===Character Palette Data===

ROM offset: '''$034084''' (unheadered)

{| class="wikitable"
! Palette !! Colors !! Description
|-
| 0 || 16 || Benjamin (normal)
|-
| 1 || 16 || Kaeli (forest green)
|-
| 2 || 16 || Tristam (blue armor)
|-
| 3 || 16 || Phoebe (red outfit)
|-
| 4 || 16 || Reuben (yellow/gold)
|-
| 5 || 16 || Benjamin (underwater)
|-
| 6 || 16 || Benjamin (poison status)
|-
| 7 || 16 || Benjamin (petrify status)
|-
|}

===Enemy Palette Data===

Enemy palettes are 8 colors each (3BPP):

{| class="wikitable"
! Palette !! Description
|-
| 0 || Green enemies (goblins, plants)
|-
| 1 || Blue enemies (water creatures)
|-
| 2 || Red enemies (fire creatures)
|-
| 3 || Brown enemies (earth creatures)
|-
| 4 || Purple enemies (magic creatures)
|-
| 5 || Gray enemies (metal/stone)
|-
| 6 || Yellow enemies (electric)
|-
| 7 || Boss-specific palettes
|}

===Menu Palette Data===

ROM offset: '''$038200''' (unheadered)

{| class="wikitable"
! Palette !! Colors !! Description
|-
| 0 || 16 || Main menu text
|-
| 1 || 16 || Battle menu
|-
| 2 || 16 || Item menu
|-
| 3 || 16 || Magic menu
|-
| 4 || 16 || Status screen
|-
| 5 || 16 || Dialog boxes
|-
| 6 || 16 || Window borders
|-
| 7 || 16 || HP/MP bars
|-
|}

==Font Graphics==

===Font Tile Data===

ROM offset: '''$058000''' (unheadered)

Font uses '''2BPP format''' (4 colors):

{| class="wikitable"
! Character Range !! Tiles !! Description
|-
| $20-$7e || 95 tiles || ASCII printable characters
|-
| $80-$9f || 32 tiles || Extended characters (European)
|-
| $a0-$df || 64 tiles || Item/menu icons
|-
| $e0-$ff || 32 tiles || Special symbols
|-
|}

Each character is 8×8 pixels (1 tile).

===Font Palette===

{| class="wikitable"
! Color Index !! RGB !! Description
|-
| 0 || Transparent || Background (not drawn)
|-
| 1 || White ($7fff) || Main text color
|-
| 2 || Gray ($52aa) || Shadow/outline
|-
| 3 || Black ($0000) || Border
|}

==Battle Graphics==

===Battle Background Data===

{| class="wikitable"
! ROM Offset !! Size !! Background !! Used In
|-
| $060000 || $2000 || Forest || Foresta region battles
|-
| $062000 || $2000 || Desert || Hill of Destiny, sand areas
|-
| $064000 || $2000 || Water || Aquaria region battles
|-
| $066000 || $2000 || Lava || Fireburg region battles
|-
| $068000 || $2000 || Sky || Windia region battles
|-
| $06a000 || $2000 || Dark Void || Boss battle backgrounds
|-
|}

===Battle UI Elements===

{| class="wikitable"
! Element !! ROM Offset !! Size !! Format
|-
| HP/MP bars || $06c000 || $0400 || 2BPP
|-
| Damage numbers || $06c400 || $0200 || 2BPP
|-
| Status icons || $06c600 || $0300 || 2BPP
|-
| Menu cursor || $06c900 || $0100 || 2BPP
|-
| Attack effects || $06ca00 || $1000 || 4BPP
|-
|}

==Sprite OAM Data==

===OAM Entry Format===

Each sprite Object Attribute Memory (OAM) entry is 4 bytes:

{| class="wikitable"
! Byte !! Bits !! Description
|-
| 0 || 7-0 || X position (low 8 bits)
|-
| 1 || 7-0 || Y position (8 bits)
|-
| 2 || 7-0 || Tile number (starting tile)
|-
| 3 || 7 || X position (high bit, bit 8)
|-
| 3 || 6 || Sprite size (0=small, 1=large)
|-
| 3 || 5-4 || Priority (0-3, higher = in front)
|-
| 3 || 3-1 || Palette (0-7)
|-
| 3 || 0 || Flip horizontally
|-
|}

Extended OAM byte:
{| class="wikitable"
! Bit !! Description
|-
| 1 || Flip vertically
|-
| 0 || X position bit 9 (for > 256 pixel X)
|}

===Sprite Size Modes===

{| class="wikitable"
! Mode !! Small Size !! Large Size
|-
| 0 || 8×8 || 16×16
|-
| 1 || 8×8 || 32×32
|-
| 2 || 8×8 || 64×64
|-
| 3 || 16×16 || 32×32
|-
| 4 || 16×16 || 64×64
|-
| 5 || 32×32 || 64×64
|}

FFMQ primarily uses mode 0 and 3.

==Animation Data==

===Animation Frame Table Format===

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || byte || Number of frames in animation
|-
| $01 || byte || Animation speed (frames per update)
|-
| $02 || byte || Loop type (0=once, 1=loop, 2=ping-pong)
|-
| $03 || byte || Reserved
|-
| $04+ || variable || Frame data entries
|}

===Frame Data Entry===

Each frame entry is 8 bytes:

{| class="wikitable"
! Offset !! Size !! Description
|-
| $00-$01 || word || Tile data pointer (ROM offset)
|-
| $02 || byte || Palette index
|-
| $03 || byte || Sprite width (in tiles)
|-
| $04 || byte || Sprite height (in tiles)
|-
| $05 || byte || X offset (signed)
|-
| $06 || byte || Y offset (signed)
|-
| $07 || byte || Frame duration (in game ticks)
|}

'''Complete animation tables for all characters and enemies:'''

'''Character animations:''' ROM $062c4c-$0638eb (see Character Sprites section above)
* Each character: 30-35 frames total
* Frame table structure: 8-byte header per frame (tile count, duration, flags) + OAM data (4 bytes per tile)
* Walking cycles: 4 frames/direction @ 8 ticks/frame = 32 ticks per loop (0.53 seconds @ 60fps)
* Attack animations: 6 frames @ variable duration (fast swing 4 ticks, hold 8 ticks, recovery 6 ticks)
* Magic casting: 4 frames @ 10 ticks each = 40 ticks total (0.67 seconds)
* Victory pose: 3 frames @ 16 ticks each = 48 ticks (0.8 seconds)

'''Enemy animations:''' ROM $037000-$037fff (animation table bank)
* Idle animation: 2-4 frames looping @ 12-16 ticks/frame
* Attack animation: 3-6 frames @ 6-10 ticks/frame
* Hit reaction: 2 frames @ 4 ticks/frame (flash white)
* Death animation: 4-8 frames @ 8 ticks/frame (fade/explode effect)

'''Boss animations:''' Enhanced frame counts
* Flamerus Rex: 20 frames (idle 8 + attack variants 12)
* Dark King: 24 frames (4 phases × 6 frames each)
* Phase transition: Special 10-frame morph sequence @ 4 ticks/frame

'''Animation control:''' Managed by game engine AI scripts. Frame advancement triggered by tick counter ($7e0d00 RAM address). Animation data includes loop points, branching (conditional frames), and event triggers (damage frame index, projectile spawn frame).

'''Frame timing reference:'''
* 1 game tick = 1/60th second (NTSC) or 1/50th second (PAL)
* Typical idle loop: 48-64 ticks (0.8-1.07 seconds)
* Combat animations: 24-40 ticks (0.4-0.67 seconds)
* Victory/death: 48-128 ticks (0.8-2.13 seconds)

==Special Effects==

===Magic Effect Animations===

{| class="wikitable"
! Effect !! ROM Offset !! Frames !! Format !! Description
|-
| Fire || $070000 || 16 || 4BPP || Flame burst
|-
| Ice || $070800 || 16 || 4BPP || Ice crystals
|-
| Thunder || $071000 || 18 || 4BPP || Lightning bolts
|-
| Quake || $071900 || 20 || 4BPP || Ground shaking
|-
| Heal || $072100 || 14 || 4BPP || Green glow
|-
| Status || $072e00 || 10 || 4BPP || Stars/sparkles
|-
|}

===Battle Transition Effects===

{| class="wikitable"
! Effect !! ROM Offset !! Description
|-
| Spiral || $074000 || Battle entry spiral
|-
| Fade || $074400 || Victory fade-out
|-
| Flash || $074600 || Damage flash
|-
| Shake || $074800 || Screen shake data
|-
|}

==Map Graphics==

===Map Tile Data===

Each map uses tileset graphics:

{| class="wikitable"
! Map Type !! Tileset Offset !! Tile Count !! Format
|-
| Overworld || $080000 || 512 tiles || 4BPP
|-
| Town || $088000 || 256 tiles || 4BPP
|-
| Dungeon || $08c000 || 384 tiles || 4BPP
|-
| Building Interior || $092000 || 192 tiles || 4BPP
|-
|}

===Map Palette Cycling===

Some maps use palette cycling for animated effects:

{| class="wikitable"
! Effect !! Palette Range !! Speed !! Description
|-
| Water || $03-$06 || 8 frames || Flowing water animation
|-
| Lava || $04-$07 || 4 frames || Bubbling lava
|-
| Waterfall || $05-$08 || 6 frames || Falling water
|-
| Torches || $0e-$0f || 10 frames || Flickering flames
|-
|}

'''Complete palette cycling scripts and timing:'''

Palette cycling creates animated effects by rotating color values in CGRAM (SNES color RAM). Scripts stored at ROM $070000-$070fff:

{| class="wikitable"
! Effect !! Palette Slots !! Frame Count !! Timing (ticks) !! ROM Offset !! Description
|-
| Water shimmer || $02-$05 (4 colors) || 8 || 6 ticks/frame || $070000 || Blue gradient rotation (dark → light → dark)
|-
| Lava glow || $06-$09 (4 colors) || 12 || 4 ticks/frame || $070080 || Orange/red/yellow cycle (pulsing effect)
|-
| Torch flicker || $0e-$0f (2 colors) || 10 || 8 ticks/frame || $070100 || Yellow ↔ orange alternating (random variation)
|-
| Crystal sparkle || $0a-$0d (4 colors) || 16 || 10 ticks/frame || $070180 || Rainbow cycle (R → G → B → R)
|-
| Waterfall || $02-$05 (4 colors) || 6 || 5 ticks/frame || $070200 || Vertical color scroll illusion
|-
| Energy barrier || $0b-$0d (3 colors) || 12 || 6 ticks/frame || $070280 || Cyan/magenta/yellow rotating
|-
| Dark fog || $00-$03 (4 colors) || 8 || 12 ticks/frame || $070300 || Dark gray gradient slow pulse
|-
|}

'''Palette cycling script format:'''
{| class="wikitable"
! Offset !! Size !! Description
|-
| $00 || byte || Palette slot start ($00-$0f)
|-
| $01 || byte || Number of colors to cycle (2-8)
|-
| $02 || byte || Frame count in cycle (2-16)
|-
| $03 || byte || Ticks per frame (4-12)
|-
| $04 || word[16] || Color data (BGR555 format, up to 16 colors)
|-
|}

'''Cycle execution:''' Palette cycling runs on NMI interrupt (60Hz). Each frame, active scripts check tick counter and advance to next color in sequence. When cycle completes, loops back to first color. Multiple effects can run simultaneously using different palette slots.

'''Performance:''' Each palette write takes 1 CPU cycle. Cycling 4 colors takes ~40 CPU cycles per frame. Maximum 8 simultaneous cycling effects before slowdown.

==Compression==

Final Fantasy: Mystic Quest uses '''no compression''' for graphics data. All tiles are stored uncompressed in the ROM.

This simplifies graphics hacking but increases ROM space usage.

==Graphics Hacking Notes==

* All graphics are uncompressed - direct tile replacement possible
* 4BPP character sprites at $020000-$02ffff
* 3BPP enemy sprites at $030000-$037fff
* Palettes at $034084 (characters), $038200 (menus)
* Font at $058000 (2BPP format)
* OAM sprite limit: 128 sprites per frame
* Tile VRAM limit: 512 tiles (4BPP), 1024 tiles (2BPP)

'''Graphics extraction and insertion tools:'''

* '''YY-CHR''' - Universal tile editor (4BPP/3BPP/2BPP support, palette editing, view raw ROM tiles)
  - Open ROM in 4BPP mode, navigate to $020000 for character sprites
  - Supports live palette editing and export to PNG
* '''Tile Molester''' - Alternative tile viewer/editor (Java-based, cross-platform)
  - Codec: "4bpp planar, composite" for SNES 4BPP tiles
  - Good for batch tile extraction
* '''SNES Palette Editor''' - Dedicated palette tool (BGR555 format, visual color picker)
  - Load palette from ROM $030000 (16 palettes × 16 colors)
  - Export/import .PAL files for sharing
* '''Lunar Compress''' - Compression/decompression (though FFMQ uses no compression!)
* '''snestools** - Command-line tile/palette extraction suite
  - Extract all tiles: `snestools extract-tiles ffmq.sfc --offset 0x20000 --format 4bpp`
  - Extract palette: `snestools extract-pal ffmq.sfc --offset 0x30000`
* '''GFX extraction complete:''' 16 palettes extracted to JSON (see `data/extracted/graphics/palettes/palette_00.json` through `palette_15.json`), 63+ tiles extracted to PNG (`data/extracted/graphics/tiles/`)

'''Sprite metasprite OAM tables:'''

Metasprites combine multiple 8×8 hardware sprites (OAM entries) into larger objects. SNES OAM limit: 128 sprites per frame.

'''OAM entry structure (4 bytes per sprite):'''
{| class="wikitable"
! Offset !! Bits !! Description
|-
| $00 || 8 || X position (low 8 bits)
|-
| $01 || 8 || Y position (0-239)
|-
| $02 || 8 || Tile index ($00-$ff)
|-
| $03 || 7-6 || Palette ($0-7)
|-
| $03 || 5 || Priority (0=low, 1=high)
|-
| $03 || 4 || Horizontal flip
|-
| $03 || 3 || Vertical flip
|-
| $03 || 2-0 || Reserved/Size
|-
|}

'''Metasprite table format (character sprites):'''
* ROM $062c4c-$0638eb (character metasprite data)
* Each frame: 1-byte sprite count + (4 bytes per sprite × count)
* Example: Benjamin walking frame 0 = $08 (8 sprites) + 32 bytes OAM data
* Sprite coordinates relative to character origin (signed X/Y offsets)

'''Metasprite table format (enemy sprites):'''
* ROM $037000-$037fff (enemy metasprite tables)
* Same 4-byte OAM structure
* Larger enemies use 16-32 sprites per frame (e.g., Dark King uses 48 sprites in final form!)

'''OAM optimization notes:'''
* Game limits active enemies to 4 simultaneously to avoid OAM overflow
* Large bosses temporarily disable player sprite during close-ups (frees 16 sprites)
* Particle effects (magic, projectiles) share OAM pool - max 32 particles active

=Related=

* [[Final Fantasy: Mystic Quest/Enemies]] - Enemy sprite data references
* [[Final Fantasy: Mystic Quest/Attacks]] - Attack animation data
* [[Final Fantasy: Mystic Quest/ROM map]] - Complete ROM structure

{{Internal Data}}
